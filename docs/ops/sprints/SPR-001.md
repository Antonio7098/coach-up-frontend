# Sprint SPR-001 — MVP Chat Core

Ship realtime chat streaming via SSE end-to-end: backend API route streams tokens; frontend SSE client renders and reconnects robustly.

## Meta
- Sprint ID: SPR-001
- Status: planned
- Start date: <YYYY-MM-DD>
- End date: <YYYY-MM-DD>
- Links: [Overview](./overview.md) · [PRD](../../planning/prd.md) · [Technical Overview](../../planning/technical-overview.md) · [Monitoring](../../ops/monitoring.md) · [Benchmarking](../../ops/benchmarking.md) · [Features CSV](../features.csv)

## Objectives (Tick when achieved)
- [ ] Deliver streaming chat via SSE end-to-end (backend -> frontend)
- [ ] Robust SSE client with reconnect/backoff
- [ ] Basic latency metrics and logs wired for chat path

## Planned Tasks
- [ ] Implement Chat API Route (/api/chat) — <owner> (<estimate>)
   - [ ] Stream tokens using Web Streams/SSE
   - [ ] Include requestId headers and structured logs
- [ ] Implement Realtime Chat SSE UI — <owner> (<estimate>)
   - [ ] SSE client hookup and message rendering
   - [ ] Input -> request pipeline with abort/cancel
- [ ] Reconnect & Backoff Logic — <owner> (<estimate>)
   - [ ] Exponential backoff + jitter
   - [ ] Visible status (connecting/connected/retrying)

## Scope
In scope
- Chat API route that streams tokens
- Frontend SSE client and reconnect logic

Out of scope
- Auth (Clerk) integration beyond dev mode
- Provider abstraction/benchmarking (deferred to SPR-006)
- Persistent transcript storage (SPR-003)

## Features in this Sprint
List feature IDs from Features CSV (pipe-separate multiple)
- [ ] FEAT-001 — Realtime Chat SSE (frontend)
- [ ] FEAT-002 — Chat API Route (/api/chat) (backend)
- [ ] FEAT-018 — SSE Client & Reconnect Logic (frontend)

## Acceptance Criteria
- [ ] Chat messages stream incrementally to the UI via SSE
- [ ] Client auto-reconnects; no user action needed for transient drops
- [ ] E2E smoke passes for a full chat turn; no P0 bugs

## Risks & Mitigations
- Risk: SSE disconnects on mobile networks · Mitigation: aggressive backoff, keep-alives, smaller event payloads
- Risk: Browser compatibility issues · Mitigation: feature-detect EventSource, fallback strategy noted

## Dependencies
- Depends on features/sprints: NA
- External: NA

## Technical Details
### Database Models
- Collections/Tables impacted: NA (no persistent storage in this sprint)
- New/changed fields: NA
- Constraints/validation: NA
- Indexes (read/write paths): NA
- Migrations: NA — Backfill plan: NA
- Data retention: NA

### Algorithmic Details
- Approach: Stream-from-LLM to client via server relay; minimal buffering
- Rubric Version: NA
- Latency targets: TTFT < 1.2s; full-turn < 2.5s

### Prompts & Rubrics
- Prompt names/links: baseline chat prompt
- Judge/rubric key points: clarity of streaming, no hallucinated UI states

## QA & Testing
- [ ] Unit tests updated/added (API handler, SSE client utils)
- [ ] E2E happy path green (Playwright)
- [ ] Load/SSE smoke test passes (k6)
- [ ] Contract tests for API routes

## Observability & SLOs
Targets (see Technical Overview §10)
- Realtime chat p95 TTFT < 1.2s; full-turn < 2.5s
- Assessment p95 completion < 8s

Checkpoints
- [ ] Dashboards exist/updated (links)
- [ ] Alerts configured (links)
- [ ] Structured logs include requestId, provider, modelId, tokens, cost, latency

## Issues & Deviations
Use this section to log issues encountered during the sprint, how they were resolved, and any deviations from the plan.

- Date: <YYYY-MM-DD> — Issue: <short summary> — Impact: <scope/users/services>
  - Detection: <alert/log/user report>
  - Fix: <what changed> — PR: <link> — Owner: <name>
  - Follow-up: <test/monitoring/doc action>
- Deviation from plan: <what changed and why>

## Documentation
- [ ] API reference updated for endpoints touched (Core & AI)
- [ ] OpenAPI spec updated and linted
- [ ] Examples added/verified (curl + TypeScript)
- [ ] Cross-links updated (PRD/Technical Overview)

## Post-sprint
- [ ] KPIs reviewed; compare to targets
- [ ] Retrospective completed; action items filed
- [ ] Docs updated (PRD/Tech Overview/Runbooks)

## Change Log
- 2025-08-19 Created sprint page
